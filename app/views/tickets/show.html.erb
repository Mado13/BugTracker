<h1 class="title">Ticket #<%= @ticket.id %></h1>

<small class="add-edit-record"><%=link_to 'Edit Ticket', edit_ticket_path(@ticket)%></small>

<div id="ticket-and-comments">
  <div id="ticket-info-section" >
    <table class="table">
        <thead>
          <th>Title</th>
          <th>Priority</th>
          <th>Status</th>
          <th>Category</th>
          <th>Project</th>
        <thead>
        <tbody>
          </tr>
            <td><%= @ticket.title %></td>
            <td><%= @ticket.priority %></td>
            <td><%= @ticket.status %></td>
            <td><%= @ticket.category %></td>
            <td><%= link_to @ticket.project.title, project_path(@ticket.project) %></td>
          </tr>
        </tbody>
      </table>
      <br>
      <div><strong>Description:</strong></div>
      <p id="ticket-description"><%= @ticket.description %></p>

    <div id="assigned-developers">
      <h3 class="title">Assigned Developers</h3>
      <table class="table table-striped">
        <thead>
          <th>Name</th>
          <th>Surname</th>
          <th>Email</th>
        <thead>
        <tbody>
          <%= render partial: 'developer', collection: @ticket.developers, as: :developer %>
        </tbody>
      </table>
    </div>

    <div id="ticket-details">
      <h3 class="title">Ticket Details</h3>
      <table class="table">
        <thead>
          <th>Submitter</th>
          <th>Last update</th>
          <th>Created on</th>
        </thead>
        <tbody>
          <tr>
            <td><%= @ticket.lead_developer.email %></td>
            <td><%= @ticket.updated_at.to_s(:short) %></td>
            <td><%= @ticket.created_at.to_s(:short) %></td>
          </tr>
        </tbody>
      </table>
    </div>

<%= turbo_frame_tag 'comments_form' do %>
  <div id="comments-section">
      <h3 class="title"> Add a Comment </h3>
      <%= simple_form_for @new_comment, url: ticket_comments_path(@ticket), format: :turbo_stream do |f|%>
        <%= f.hidden_field :user_id %>
        <%= f.hidden_field :ticket_id %>
        <div class="mb-3 col">
          <%= f.input :comment%>
        </div>
        <%= f.button :submit, "Leave a comment", class: "btn btn-success"%>
      <% end %>
  </div>
<% end %>

<%= turbo_stream_from "comments" %>
<%= turbo_frame_tag "comments" do %>
  <%= render @ticket.comments %>
<% end %>
